<!DOCTYPE html>
<html>
<head>
    <title>Debug Accommodation Data</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        pre { background: #f0f0f0; padding: 15px; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Debug Accommodation Data</h1>
    <div id="output"></div>
    
    <script>
        const output = document.getElementById('output');
        
        // Find the user ID
        const userStr = localStorage.getItem('wanderplan_user');
        if (!userStr) {
            output.innerHTML = '<p class="error">No user found in localStorage</p>';
        } else {
            const user = JSON.parse(userStr);
            output.innerHTML += `<p class="success">User ID: ${user.id}</p>`;
            
            // Get preferences
            const prefsKey = `wanderplan_preferences_${user.id}`;
            const prefsStr = localStorage.getItem(prefsKey);
            
            if (prefsStr) {
                const prefs = JSON.parse(prefsStr);
                output.innerHTML += '<h2>Current Preferences Data:</h2>';
                output.innerHTML += '<pre>' + JSON.stringify(prefs, null, 2) + '</pre>';
                
                // Check accommodation_style specifically
                if (prefs.accommodation_style) {
                    output.innerHTML += '<h2>Accommodation Style Field:</h2>';
                    output.innerHTML += '<p>Type: ' + typeof prefs.accommodation_style + '</p>';
                    output.innerHTML += '<p>Is Array: ' + Array.isArray(prefs.accommodation_style) + '</p>';
                    output.innerHTML += '<pre>' + JSON.stringify(prefs.accommodation_style, null, 2) + '</pre>';
                    
                    // Show what the UI should display
                    output.innerHTML += '<h2>What UI Should Display:</h2>';
                    if (Array.isArray(prefs.accommodation_style)) {
                        const styles = prefs.accommodation_style.map(item => {
                            if (typeof item === 'string') return item;
                            if (item && typeof item === 'object' && item.style) return item.style;
                            return null;
                        }).filter(Boolean).join(', ');
                        output.innerHTML += '<p class="success">Should show: ' + styles + '</p>';
                    } else if (typeof prefs.accommodation_style === 'object' && prefs.accommodation_style.style) {
                        output.innerHTML += '<p class="error">ERROR: accommodation_style is a single object, not an array!</p>';
                        output.innerHTML += '<p>Should show: ' + prefs.accommodation_style.style + '</p>';
                    }
                }
                
                // Check accommodation_type too
                if (prefs.accommodation_type) {
                    output.innerHTML += '<h2>Accommodation Type Field (old):</h2>';
                    output.innerHTML += '<pre>' + JSON.stringify(prefs.accommodation_type, null, 2) + '</pre>';
                }
            } else {
                output.innerHTML += '<p class="error">No preferences found</p>';
            }
        }
    </script>
</body>
</html>